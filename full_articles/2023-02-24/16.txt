![](https://img.foresightnews.pro/202302/96bc713c58822d5b167c0c37284d24b6?x-oss-process=style/scale70)Arweave 是目前存储赛道的龙头项目，除了主打永久存储以外，还凭借其对智能合约的支持，成为了一条可以承载各种上层应用的平台型公链。然而自 Arweave 上线以来，尽管已经涌现出了一些代表性项目，但其生态中的 DeFi 类应用却发展的一直不温不火。

这与 DeFi Summer 以来行业的主流发展趋势产生了很大区别。自 20 年以后，几乎每条公链都会标配去中心化交易所等 DeFi 组件，各类 DeFi 协议的锁仓量也成为了判断一条公链潜在价值的关键指标。而 Arweave 在 DeFi 上的短板，也直接导致了其上的原生 PST 代币缺少足够的流动性支持，优秀的项目也难以快速的进行融资。

### Arweave 生态中为何长期缺少 DEX？

其实严格来说，Arweave 生态并非一直没有 DEX 类的项目。早在 Permaswap 之前，便有名为 Verto 的项目在进行这方面的探索。但 Verto 却在后续的开发中遇到了比较大的障碍，作为 Arweave 生态第一个 DEX 的 Verto 目前已经处于无法使用的状态。而导致这个结果的根本原因，则在于 Arweave 上原生智能合约系统的底层缺陷。

我们知道，想在链上构建复杂的交易逻辑，就必须有智能合约功能的支持。但限于 Arweave 只能在公链层面对存储达成共识，虽然可以在其上保存合约的代码，但却无法在链上对其最新的状态进行计算。因此，对 Arweave 中智能合约的计算需要依靠链下主体进行。比如 Arweave 智能合约的使用者如果需要了解其应用的最新状态，则需要将代码与后续交易记录全部下载，并在自己的本地重新进行计算，才能得到最新的状态。

这种在 Arweave 生态中的原生智能合约架构，被称为 SmartWeave。

SmartWeave 形式的智能合约虽然通过链下计算极大地提高了效率，但同时也引入了新的风险，那就是这个系统更容易受到 DDOS 攻击。比如 SmartWeave 的攻击者完全可以利用 Arweave 存储成本低廉的特性，向 Arweave 提交大量无效交易指令。而 SmartWeave 的使用者则只能下载全部的无效数据并进行完整的计算后，才能得到最新的状态。

这样，一个攻击者就可以以很低的成本，实现瘫痪 SmartWeave 智能合约的目标，这也是造成 Verto 的开发长期处于停滞状态的根本原因。

因此，想要在 Arweave 中构建 DeFi 类应用，就必须在系统底层解决 SmartWeave 的原生缺陷。而 everFinance 团队（同时也是 Permaswap 的开发团队）提出的存储共识范式（Storage-based Consensus Paradigm，简称为 SCP），正是对这一问题的直接回应。

那么存储共识范式 SCP 相较于 SmartWeave 又有哪些具体的改进呢？

### everPay 与存储共识范式

用比较通俗的话讲，SCP 相较于 SmartWeave 最大的改进，便是在所有交易被提交到 Arweave 之前，增加了一个被称为协调者（Coordinator）的中心化节点，提前对这些交易进行过滤与验证。如果在验证过程中发现了用于攻击的错误交易，那么该节点便会提前进行处理，使得只有有效的交易才能最终被提交上链。

![](https://img.foresightnews.pro/202302/572a6ba13d8e9a3797911b63724a2cc6?x-oss-process=style/scale70)说到这里，有些读者可能已经联想到，SCP 的设计思路其实与以太坊中的 Rollup 扩容方案非常类似。在 Rollup 方案中，同样是使用一个名为定序器（sequencer）的中心化节点负责链下主要的排序与计算工作，并将计算好的结果与相应的证明直接存储到以太坊，以此来提高系统的执行效率。

SCP 与 Rollup 两个扩容方案，虽然在节点名称上略有差别，但两者在核心思想上其实是一脉相承的。在 SCP 架构中，Arweave 承担了以太坊主网的功能，为整个系统提供底层的安全性与共识，而 everPay 则类似于以太坊中 Arbitrum 或 Optimism 这样具体的 Rollup 项目。而在 everPay 基础上构建的 Permaswap，则如同部署在 Optimism 上的 Uniswap，是构建在 everPay 这个二层网络之上的具体应用。

下面我们使用一张简图，来对比 SCP 与以太坊系统不同架构间的对应关系：

![](https://img.foresightnews.pro/202302/0d490087a5dd0f860d376ee7d02b0e8b.png?x-oss-process=style/scale70)可以看出，由 everFinance 提出的存储共识范式 SCP，使用类似以太坊 Rollup 的思路，解决了之前 Arweave 上原生智能合约系统 SmartWeave 的固有缺陷，为 Arweave 上 DeFi 生态的发展，重新打开了大门。

### Permaswap 的优势

在 everPay 成功解决了 Arweave 的原生智能合约缺陷后，在其上重新构建 DeFi 组件便成了 everFinance 团队下一步的重点目标。随着去年 12 月 12 日 Permaswap 公测版的正式上线，Arweave 生态也终于结束了长期缺少原生 DEX 的现状。

那么这个基于 everPay 开发的 DEX 与其他公链中的同类产品有哪些本质不同？下面我们便结合 Permaswap 的具体设计思路，来分析下 Permaswap 的主要优势。

### 1.无 gas 费且无 TPS 限制

是的，虽然 Permaswap 依然使用智能合约来执行交易，但是用户在使用时不需要像在以太坊中那样支付 gas 费，且该系统也没有如其他公链一样的 TPS 限制，理论上可以支持更大的每秒结算速度。只要体验过 Permaswap 的交易过程，就能明显感受到其与传统 swap 在体验上的极大不同。

当然未来如果 Permaswap 的使用量大幅增加，为了防止对系统的女巫攻击，也不排除在某一时刻开始对用户收取少量的 gas 费用。但即便如此，Permaswap 的使用成本依然会非常低廉。

### 2.即时结算，无 MEV

同样受益于 everPay 的架构优势，用户在 Permaswap 上的交易可以被及时处理，而不需要等待打包上链。因此，由区块内排序顺序所造成的 MEV 提取问题自然也不会在 Permaswap 上出现。Permaswap 的用户可以享受到相对更加合理的结算价格。

### 3.用户与 LP 的资产不需要托管

DEX 之所以相较中心化交易所更加去中心化，很大一个原因在于 DEX 使得用户不再需要托管资产。尤其从最近以 FTX 为代表的各种爆雷事件中我们可以发现，只要中心化的机构托管了用户资产，在缺乏监管的环境下几乎必然出现挪用用户资产的问题。

但与此同时，目前的 DEX 却依然需要平台的流动性提供者（LP）在智能合约中托管资产。因此一旦这些智能合约出现安全问题，依然有可能对 LP 的资产造成重大损失。因此，未来的 DEX 如果想在去中心化上更进一步，消除智能合约风险带来的隐患，就需要解决 LP 资产的托管问题。

在 Permaswap 中，包括交易者与流动性提供者在内的所有参与者，都实现了用户资产的自我管理。可以说，Permaswap 是目前唯一一个彻底免除了资产托管风险的去中心化交易所。

当然，对资产托管风险的消除也一定程度增加了用户成为 LP 的操作门槛，毕竟安全与效率总是难以两全。比如 Permaswap 中的 LP 需要下载特定的钱包（也被称为客户端，但本质上依然是个保存私钥的钱包），并保持实时在线状态以便随时签署交易。另外，成为 LP 也需要质押一定代币（未来发行的 PSN 代币或者目前的 NFT），如果其拒绝按曲线价格签署交易，则系统会罚没期质押物。

这种设计一定程度上增加了普通用户为 Permaswap 提供流动性的门槛，因此未来 Permaswap 的 LP 预计将以机构参与者作为主体。

### 4.支持各种 LP 策略

此外，Permaswap 还支持多种 AMM 做市策略，每个 LP 可以选择适合自己的 AMM 曲线。同时，系统中的 Router 节点会在交易者提交订单后，采集系统中所有连接到 Router 节点的 LP 报价信息，并根据最优原则生成最终报价。其中 Router 的角色，可以简单的理解为类似 1inch 类型的聚合器，自动帮助用户在众多 LP 中聚合最优报价。

当然，由于底层 everPay 的计算性能不受限制，未来 Permaswap 也可以支持订单簿模式。据了解，目前团队已经在进行相关的开发工作，预计会在不久的升级中逐步实现。

![](https://img.foresightnews.pro/202302/e99c5a32b0ba44cf247d7291d59bdb5b?x-oss-process=style/scale70)### Permaswap 的意义

可以说，经过之前两年的发展，加密市场中早已不缺乏 DEX 类型的项目。Permaswap 的出现虽然给一直缺乏 DeFi 支持的 Arweave 生态增加了本地交易功能，但其真正的意义恐怕还不限于此。

我们知道，目前不论是中心化的交易所，还是去中心化的各类 DEX 项目，并没有任何一个类型可以完全满足市场对于交易的基本需求。中心化交易所速度快，成本低，但是需要用户承担其作恶风险。而去中心化的 DEX 虽然免除了托管风险，但是交易成本和结算速度都不甚理想。

而基于存储范式的 Permaswap 出现后，市场上第一次出现了一个集合了中心化交易所结算速度，与去中心化交易所高可信优势的交易产品。可以说，Permaswap 一定程度上填补了之前市场的空白。当然，最后用户是否可以真正认可这个独特的产品定位，依然需要经过市场的最终考验。

### 目前的 Permaswap 还有哪些不足

目前上线的 Permaswap 还只是 Beta 版本，因此其在产品细节以及底层架构上都还存在着许多值得持续优化的空间。

比如其依托的底层扩容方案 everPay ，虽然已经完全能够为 Permaswap 提供高效的支付结算处理服务，但目前其依然没有实现其白皮书中的全部开发目标。

我们在上文曾经谈到，everPay 的架构与以太坊中的 Rollup 架构非常相似，都是通过链下计算的方式扩充底层公链的交易处理效率。但是采用链下计算方案的缺点是，整个系统将必须增加一些额外的机制来保证这些节点的诚实可信。

因此在 everPay 目前的方案中，除了负责打包结算的协调者（Coordinator）以外，还增加了新的“检测者（Detectors）”角色，专门用于负责监督协调者以保证其诚实可信。目前成为 everPay 的检测者是完全开放且开源的，社区中的任何成员都可以从 Arweave 下载相关的历史交易记录并进行自主验证。其运行机制需要在实践中接受更多的考验。

当然，如果依照 everPay 的开发路线图，未来协议还将进一步增加安全措施，而其中非常关键的一步便是发行代币。我们知道，通过经济激励机制，对诚实守信的节点进行激励，对失信节点进行惩罚，将是更加长久可靠的安全措施。

此外，Permaswap 在产品层面也有一些细节问题需要解决。比如被 Arweave 社区广泛期待的 PST 代币交易功能，目前便受阻于一些技术细节问题，需要更多的时间逐步解决。感兴趣的读者可以点击下方链接了解最新的进展：<https://medium.com/permaswap/we-need-a-consensus-about-pst-2f95c007cc68>

可见，新上线的 Permaswap 并非以太坊 DeFi 项目的简单复制品，而是希望通过采用不同的底层架构范式，重新在效率与安全中寻求新的平衡，以达到更好用户体验的去中心化加密资产交易平台。

并且作为目前 Arweave 生态中唯一可用的 DeFi 项目，Permaswap 的上线必将刺激整个 Arweave 生态的发展，也为整个 DeFi 赛道的发展提供了崭新的思路。

🔗 **关于 PermaDAO 更多信息：**[**Website**](https://www.notion.so/PermaDAO-4c0bd73f5a1c4410ad72a32e1718ebb6) **|** [**Twitter**](https://twitter.com/perma_daoCN) **|** [**Telegram**](https://t.me/+UEnIssIHTn0wZDc1) **|** [**Discord**](https://discord.gg/y6CmaAdVD8) **|** [**Medium**](https://medium.com/@permadao) **|**[**Youtube**](https://www.youtube.com/@permadao)

![](https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=fac972bb1d27)