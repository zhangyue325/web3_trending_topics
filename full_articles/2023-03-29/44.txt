最近 Trade joe V2 因为从 Uniswap 手里抢到大量 Arb 交易份额而火爆，币价迅速翻倍。那么其究竟是如何做到的？为其提供流动性又需要注意些什么？

本文将带你深入浅出的了解 Joe V2 的机制，分析其为何能在 $ARB 交易中获取大量份额，以及产品的优劣势，帮助你更好地理解 DEX。

![](https://img.foresightnews.pro/202303/5-1680054009811.webp?x-oss-process=style/scale70)

Trade Joe V2 简单概括：

* AMM 类似订单簿，使用非连续流动性
* 最小价格精度基于比例而非固定数值
* 垂直聚合流动性带来更好的可组合性
* 基于 LP 获取的交易手续费和有效 TVL 的来进行流动性激励
AMM 机制
------

接下来以 Joe V2 中的 ARB/ETH 20bps 池为例来进行深入分析，首先我们看一下池的流动性分布，咋一看跟 UNI V3 是挺像的。

![](https://img.foresightnews.pro/202303/5-1680054032482.webp?x-oss-process=style/scale70)

那么其根本性不同在什么地方？Joe V2 的一个长条（bin）即对应一个单点价格，就是说除非你把这个 bin 的流动性消耗光，否则价格是不会变化的。比如下图，可以看到该 Bin 内有大约 35k Arb 和 2 ETH ，如果此时有人按 0.00066 卖了价值 2E 的 Arb，那么交易的 Bin 就会向左移动一位，价格才会发生变化。

![](https://img.foresightnews.pro/202303/5-1680054040391.webp?x-oss-process=style/scale70)

我们再对该池尝试添加流动性，发现是可以添加单点流动性，就是说添加的流动性就在一个价格上，这其实就相当于在订单簿中放一个 Maker 单。那旁边的 Pct Rage = 0.20% 是怎么回事？

![](https://img.foresightnews.pro/202303/5-1680054052993.webp?x-oss-process=style/scale70)

我们稍微移动一下右侧滑钮，将价格范围扩大到 2Bin，然后计算两个价格的相对差别。

(0.00067237272-0.00067103065)/0.00067103065 = 0.20%

也就是说 0.20% 就是最小价格精度

![](https://img.foresightnews.pro/202303/5-1680054069687.webp?x-oss-process=style/scale70)

我们看下偏离当前价格较大的情况如何，比如 ARB/ETH = 0.0001 的位置。可以得出

（0.00010035504-0.00010015473）/0.00010015473 = 0.20%

对的，可以理解为任一位置上下价格之差都是 0.2%，基于比例而非固定数值。这是和传统订单簿相差较大的地方，传统订单簿一般给一个固定数值的最小精度，比如 0.01 USDT 这样。

![](https://img.foresightnews.pro/202303/5-1680054077739.webp?x-oss-process=style/scale70)

Joe 的 UI 也给出了 4 种添加流动性的方式，点击上图右上角的 「learn more」就可以学到对其详细的定义，但是除了 Spot 之外，其他四种都是使用官方设定的参数值，不可控。所以我建议使用 Spot，存法类似 UNI V3, 大不了多存几个不同价格范围的。另外目前 Joe V2 目前有流动性激励，必须考虑这个的收益。

流动性激励
-----

目前这些池名后带有「Rewards」标签的是有流动性挖矿激励的

![](https://img.foresightnews.pro/202303/5-1680054095145.webp?x-oss-process=style/scale70)

Joe V2 的流动性挖矿激励分配模式：

* 根据 LP 实际获取的交易手续费和 MakerTVL 算出分数，参见下图
* MakerTVL 目前只看当前价格 +- 5bin 内的，比如 Arb/ETH 0.2% 的 Bin 宽度，那么只有当前价格 +-1% 以内的 TVL 才会被记入
* 当一个 Epoch 结束后，统计该 Epoch 之内的分数然后按比例集中发放
就是说如果想要获取流动性激励，还是需要比较集中地提供流动性。

![](https://img.foresightnews.pro/202303/5-1680054115623.webp?x-oss-process=style/scale70)

如想知道更多细节，可见[文档](https://joecontent.substack.com/p/liquidity-book-rewards-program-pilot?utm_source=substack&utm_campaign=post_embed&utm_medium=web)。

$ARB 交易为何获取大量份额
---------------

假设当前市场在持续买入 Arb， Uniswap Arb/USDC = 1.005，假设 Joe V2 的价格精度为 1%，bin 分布为 [0.99, 1.00, 1.01…]。这个时候 Joe 当前的 bin 应为 1.00，比 Uni 便宜 0.5% ，那只要交易费比这个差距小，通过 1inch 等聚合器买入 Arb 的交易自然就会优先走 Joe ，反之如果是卖 Arb 的话 Joe 就没有优势。也就是说其在高波动率出单边行情下较有优势，而低波动率猴市下则比较平庸。

加上 Joe 针对 ARB/ETH 的交易对设置了 0.2% 的费用，而在当时由于波动预期较高，UNI 又只能设置 0.01%/0.05% / 0.3%/1% 这四档，大部分 LP 位于 0.3% 以上档位，相比 Joe 的 0.2% 又有劣势。

高波动率下的经常性汇率优势 + 相对较低的费率，使得 Joe V2 在 ARB 0.00 启动初期获取了大量的份额。目前随着波动率的下降，其汇率也不再有经常性优势；UNI V3 LP 回归 0.05% 费用的池子，也基本失去费率优势，所幸名声打出来了，加上其有不错的激励机制，给了项目方更大的操作空间。

产品优劣势
-----

实际上在上面的 Arb 交易份额论述中，其 AMM 机制带来的优劣已经说明，这一节讨论其他方面：

1. 垂直聚合流动性带来更好的可组合性
2. 高效率 + 支持激励，可以拿到合作方的激励，比如有望受益于 LSD war
* 没有成熟的 Bribe 等代币赋能机制，代币持有者收益有限
* 无常损失相对较大
### 优势：可组合性

由于在 Joe V2 中，流动性是通过每个 bin 垂直聚合的，而在 Uniswap V3 中，流动性是横向聚合的。垂直聚合的主要好处是它允许流动性可替代。

![](https://img.foresightnews.pro/202303/5-1680054176742.webp?x-oss-process=style/scale70)

我们看一笔具体添加流动性的交易，会发现在用户添加 ETH/USDC 后，Joe 给用户返回了大量不同 Token ID 的 ERC-1155 LBT，反应了用户在不同价格水平上的流动性分布。

这跟返回单个 NFT 的 UNI V3 有较大差别。因为相同 Token ID 代表流动性位于单个 Bin/ 价格水平内，这是同质化的，具有更好的可组合性。

### 优势：合作方激励预期

集中流动性高效率 + 支持激励，有望吸引到 LSD 等有流动性需求的合作方来提供激励，比如此前 UNI V3+ 激励 模式 Kyberswap, 就从 Lido 拿到了仅次于 Curve 的激励分配（参见下方推文） ，并且占据了极大的 Alt-l1/L2 的 LSD 交易量份额。

那么能够提供类似价值的 Joe V2 理论上也有这个机会，从而提升 TVL 和交易量。

### 劣势：代币赋能问题

如我[此前推文](https://twitter.com/NintendoDoomed/status/1620725139909509120?s=20)所述，纯现货 DEX ，如果没有 bribe 这类额外赋能机制的话，是比较困难的，空有 TVL 和交易量却无法转化为代币持有者的收益。

目前是 Joe 通过手续费抽成来获取收益，但抽多了又势必影响份额。Joe 虽然有 Ve Joe, 但并不是复制 Curve 走 Bribe 这条路，目前看来并不十分成功，因此代币赋能仍然是个问题。

### 劣势：无常损失相对较大

如前文所述，单边行情下 Joe V2 有经常性汇率优势，但这对于 LP 而言实际上是承担了更大的无常损失，相当于更便宜的把币卖了。

Joe 会合理设置费用来补足这一点，比如 1% bin 宽度的 ARB/USDC 费用为 0.8%，0.2% bin 宽度的 ARB/ETH 费用为 0.2%。加上此点并不容易察觉，所以还好（笑

总结
--

Trade Joe V2 相对 UNI V3 在效率上更多的是做到了特定场景下的差异化优势，而高可组合性这个优势的发挥非常依赖其的自身规模。因此后续应该持续关注项目方的 BD 等操作，看能否 BD 到足够的合作激励，构建起增长飞轮。

