NFT 和 Web3 一直在掀起波澜，但对于加密新人来说，购买和存储它们的过程仍然需要简化。

我记得第一次在 Uniswap 上交易时，我甚至不知道自己在做什么。创建一个加密钱包并将其连接到 DeFi 协议是一场噩梦。

当前，用户与区块链特定智能合约交互的唯一方式是使用他们的 EOA（外部拥有账户）。从将资金发送到 DeFi 流动性池，到将 NFT 转移到市场以出售给其他账户，每一个行为仍然需要单独的交易签名。 

虽然我们中的许多加密老手已经接受了这个过程，但初学者？当大多数人已经体验过传统银行业务的便利性时，他们不会喜欢创建和使用 EOA。

这些对于让新用户进入 Web3 领域仍然是一个挑战。

这就是 ERC-4337 的用武之地。

本文将深入探讨 ERC-4337，了解其特性，并探讨其对加密行业和 Web3 的影响。

什么是以太坊账户？
---------

以太坊有两种不同类型的「账户」：

*你可以将合约账户（CA）视为区块链上的代码（智能合约），将 EOA 视为一个人（尽管一个人可以拥有多个 EOA）。*

你的 MetaMask 钱包就是一个 EOA。EOA 由一对加密密钥组成：控制账户活动的公钥和私钥。

然而，合约账户没有私钥。它们是智能合约，由其中的代码逻辑控制，不受用户控制。智能合约有能力做任何你可以用代码编写的事情，而 EOAs 基本上只能签署交易。

关键要点是：**代码**定义**合约账户**做什么，而**用户**控制**EOA**做什么。

什么是以太坊交易？
---------

每次你想向区块链写入信息，比如转移代币，或者铸造 NFT，都需要进行交易。交易需要 EOA 签名，EOA 也需要支付与这笔交易相关的 Gas 费用。

交易由 EOA 发起，可以发送至：

* 另一个 EOA，例如，一个 EOA 将 ETH 转移到另一个 EOA。
* 一个 CA，例如，铸造 NFT。
今天的 Web3：EOA+ 糟糕的用户体验
---------------------

在区块链上执行操作通常是缓慢而乏味的。每次你想向区块链写入新信息时，你都需要从你的 EOA 中签署一项交易才能这样做。

由于你已经熟悉了这个过程，所以这也成为了一种标准体验。

然而，对于新用户来说，这却是一场噩梦。

下图展示了一个新用户如何通过新的 EOA 在去中心化应用程序（dApp）上执行他们的第一个操作：

![](https://img.foresightnews.pro/202303/713cc1c69dfabfb7d2fec1a819d3fbd8.png?x-oss-process=style/scale70)

这些步骤对于任何新用户来说都是残酷的，无论是否了解区块链这项技术。

但新用户面临的问题还远不止于此。

### **EOA 风险极大**

你可能身边已经熟悉一些因意外泄露或丢失私钥而失去对 EOA 的访问权的朋友。

甚至加密行业有一句谚语：「Not your keys, Not your crypto」。指的是如果其他人（例如黑客）拥有了你的私钥，他们就能够控制你的资金。这一点在过去已经被无数次证明。

这就是残酷的现实，私钥很容易丢失，无法找回。

### **EOA 能力有限**

正如我们之前提到的，EOA 的能力非常有限。

在 EOA 中，你通常会执行以下两种典型操作：

1. 提交交易，将代币转移到另一个 EOA
2. 提交交易，在合约账户上执行某种功能
### **EOA 永远不会被主流采用**

在现实世界中，丢失银行卡并不意味着你就 Game Over 了。

有一些规则允许你将资金更换到新账户、执行支付限额、冻结银行卡、仅允许在特定条件下转移资金等操作。

然而在 Web3 中，如果你犯了一个错误，你的整个账户就会受到损害并且无法恢复。

所以，EOA 与中心化的货币存储相比，甚至是糟糕的。

那么有没有解决方案呢？

账户抽象
----

账户抽象是一种允许用户使用 CA 的提议。

但是为什么呢？CA 有哪些 EOA 不能做的事情？

CA 的功能比 EOA 灵活得多。（因为智能合约可以在其代码中定义不同的规则和配置）

下面是一些用例示例：

![](https://img.foresightnews.pro/202303/a23dcfb99688f1febd4bfbf4897b6293.png?x-oss-process=style/scale70)

这些只是 CA 能够提供优于 EOA 的部分功能。关键在于：**合约账户是代码**。这意味着你可以用代码编写任何东西并在 CA 中实现。

账户抽象的历史
-------

听起来很不错，但我们为什么不立马这样做呢？在回答这个问题之前，让我们快速回顾一下自 2016 年以来有关账户抽象的提案的历史。对以太坊生态系统提出的每项技术升级最初都是从 EIP （以太坊改进提案）开始的。

* 2016 年：EIP-86——提案允许用户创建执行任何所需签名 / 随机数检查的「账户合约」，而不是使用当前硬编码到交易处理中的机制。
* 2020：EIP-2938——创建类型为 AA\_TX\_TYPE 的新交易标准的提案。这种类型的交易被称为「AA 交易」。
* 2020：EIP-3074——允许用户将其 EOA 的控制权委托给智能合约的提案。允许任何 EOA 在不部署合约的情况下充当钱包。
这些提案都没有被实现到以太坊中，它们目前都属于「停滞」类别。这意味着它们已经有 6 个月或更长时间处于搁置状态。

这些提案未被实现的部分原因是它们需要对以太坊网络的共识层协议进行更改。（可以简单将「共识层」理解为以太坊系统的后端）

直到 2021 年，EIP-4337 被提出：实现以太坊上的账户抽象，而无需更改共识层！

在 2023 年 3 月 1 日丹佛的 WalletCon 上，以太坊基金会开发人员官宣 ERC-4337 的核心合约已经通过了 OpenZeppelin 的审计，通过了各项测试。目前审计后的合约已经顺利部署在以太坊主网以及若干测试网，后续也可在各个 EVM 兼容链上运作，包括 Polygon、Optimism、Arbitrum、BNB Smart Chain、Avalanche 和 Gnosis Chain 等。

EIP、ERC-4337 是什么？
-----------------

一旦链上治理接受、授权并确认 EIP，它就变成了 ERC（以太坊征求意见，主要是处理协议和开发标准）。

所以先有了 EIP-4337，才有了 ERC-4337。

ERC-4337 旨在将用户 EOA 升级为「智能账户」（类似于 CA），使账户能够作为智能合约运行。这意味着每个加密钱包都可以有可定制的授权逻辑，以满足个人用户或应用程序的需求。所以一些账户抽象的用例就此可以实现，例如恢复丢失的私钥、在没有助记词的情况下保护钱包、执行自动支付、无 Gas 交易等。

ERC-4337 添加了新的 UserOperation 内存池，希望完全取代当前的交易内存池，从而实现账户抽象。用户将 UserOperation 对象发送到以太坊节点，而不是交易，他们将一组这些对象打包成一个包含在以太坊链中的交易。这种打包交易称为「入口点」智能合约，它处理 UserOperation 对象并为其部署智能合约钱包。

![](https://img.foresightnews.pro/202303/a300c299374b77d86e0d12bd1aa1fbac.jpeg?x-oss-process=style/scale70)

*图片：ERC-4337 交易流程，来源于 Nethermind*

  


ERC-4337 最明显的好处之一是它可以使加密行业外的普通用户更容易访问以太坊，可以解决用户目前从创建钱包到使用钱包所面临的一些关键问题，让钱包变得更加简单易用。

这也是「抽象」这个词的理解方式。你可以理解为**构思**，以太坊计划通过 ERC-4337 为用户的账户带来新的想法。或者理解为**抽离**，允许用户摆脱像 MetaMask 这样的用户账户的传统处理方式——对助记词、个人交易签名和对私钥的过度依赖。 

ERC -4337 的特点
-------------

简单来说，基于 ERC-4337 的智能账户的主要特征之一是引入了「社交恢复机制」。如果你丢失了助记词，那么你可以联系之前指定的「监护人」合约或账户来帮助找回访问权限。你也可以启用 2FA（双因素身份验证）和生物识别技术来保护钱包，不一定再需要助记词。

此外，你还可以在钱包中设置自动支付和基于时间的支出限制，能够更有效地管理你的资金。

最后，ERC-4337 允许去中心化应用程序（dApp）赞助 Gas 费，从而使用户的交易更便宜、更简单。

让我们详细看看：

* **智能账户**：智能账户，也被称为账户抽象，正在成为加密行业的一个重要主题。Visa 甚至开发了一种基于智能账户的自动加密账单支付系统。随着 ERC-4337 的实施，智能账户可以提供更高级的功能和用例。
* **恢复丢失的私钥**：ERC-4337 启用了一个「社交恢复机制」，如果你丢失了私钥，那么联系之前指定的用户即可帮你恢复对账户的访问。这解决了加密行业中最重大的风险之一——丢失钱包的私钥。
* **没有助记词的安全钱包**：通过这次升级，用户可以使用 2FA 和生物识别技术来保护账户，使它们更加安全和用户友好。
* **自动交易**：ERC-4337 允许自动交易，包括每月支出限额、AI 交易和调整质押头寸。这些功能可以让用户更容易地进行交易。
* **无 Gas 交易**：ERC-4337 支持无 Gas 交易，这允许 DeFi、链游、DAO 等 dApp 为用户赞助 Gas 费用，从而使用户的交易更便宜。此功能还允许用户使用 dApp 的代币支付 Gas 费用，这可以大幅降低 dApp 的使用成本。
* **捆绑交易**：每笔交易都需要签名。通过账户抽象，可以捆绑交易，将多笔交易作为一个发送，以节省时间甚至节省 Gas 费用。类似购物车，即使面对 10 个市场也能够一笔交易完成打包。
* **预先批准交易**：假设你正在铸造多个 NFT，或者在玩一款游戏。使用智能账户，你可以根据提前设置自定义的钱包代码和会话密钥，预先批准交易。
ERC-4337 的优缺点
-------------

当前，ERC-4337 有几个潜在的好处和缺点。

* 增强了安全性，增加了功能，改进了用户体验。
* 引入了内置的访问控制、权限和更灵活的代币供应模型，使其比现有代币标准更安全。
* 灵活的代币供应模型使开发人员能够创建具有可变供应的代币，这对于需要更动态供应的 dApps 及其代币来说很有用。
* ERC-4337 中的内置访问控制和权限使用户更容易了解其代币的使用方式并控制他们与 dApp 的交互。在与 dApp 交互时，这会带来更加无缝和用户友好的体验。
* 最显著的缺点之一是它尚未被以太坊社区广泛采用。因此，在获得更多关注和支持之前，开发人员可能会犹豫是否使用它。
* ERC-4337 的另一个缺点是它与其他代币标准的兼容性有限。这意味着开发人员可能需要对其现有的 dApp 进行重大更改才能实现它，这可能既耗时又昂贵。
* 此外，ERC-4337 的新增功能可能会增加 dApp 开发的复杂性，这可能会给不熟悉新标准的开发人员带来更大的挑战。
ERC-4337 有可能提高以太坊网络上 dApp 的功能和安全性。然而，它的成功取决于以太坊社区是否愿意采用它，以及开发人员是否愿意投入必要的时间和资源在他们的 dApp 中实施它。

总结
--

我认为 ERC-4337 是加密行业和 Web3 中长期存在的可用性问题的解决方案。目前，已经有大量令人惊叹的项目实现了令人难以置信的用例。但是钱包的使用仍然是困扰新用户的一个重要问题。

ERC-4337 引入的可用性和直接性将改变游戏规则。通过将加密钱包与智能合约合并，使交易更加安全和高效，最终使用户的 Web3 体验更加友好。它是使 Web3 成为可以媲美互联网用户「正常」生活方式的催化剂，像 Coinbase 的 L2 Base 已经在使用 ERC-4337 了。

虽然 ERC-4337 的未来尚不确定，但它的推出已经在加密社区内引发了乐观情绪。随着加密货币和 Web3 的不断发展，ERC-4337 可能会为更多进步和创新铺平道路。

